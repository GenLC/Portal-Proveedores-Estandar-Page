sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/Dialog","sap/m/Button","sap/ui/Device","../model/formatter","sap/ui/core/routing/History","sap/ui/model/json/JSONModel","../Encryption/aes"],function(e,t,o,s,r,a,n,i){"use strict";return e.extend("ppe.ppe.controller.Menu",{formatter:a,onInit:function(){},getSplitAppObj:function(){var e=this.byId("MenuView");if(!e){Log.info("SplitApp object can't be found")}return e},btnChangeMenu:function(){if(this.getSplitAppObj().getMode()=="HideMode"){this.getSplitAppObj().setMode("ShowHideMode")}else{this.getSplitAppObj().setMode("HideMode")}},goToDashboard:function(){this.getSplitAppObj().to(this.createId("PageDashboard"))},goToPedidos:function(){var e=this.getOwnerComponent().getModel("LoginModel").getProperty("/CardCode");g(e,this,"desc");this.getSplitAppObj().to(this.createId("PagePedidos"))},goToFacturas:function(){this.getSplitAppObj().to(this.createId("PageFacturas"))},goToPagos:function(){this.getSplitAppObj().to(this.createId("PagePagos"))},goToCuentaCorriente:function(){this.getSplitAppObj().to(this.createId("PageCCorriente"))},goToContacto:function(){this.getSplitAppObj().to(this.createId("PagePedidosDetalle"))},btnAccount:function(){this.getSplitAppObj().to(this.createId("PageCuenta"));var e=this.getOwnerComponent().getModel("LoginModel").getProperty("/UserData");console.log(e);this.getView().byId("codeuser").setValue(e.CardCode)},legajoImpositivo:function(){debugger;var e="/b1s/v2/WTaxTypeCodes";jQuery.ajax({url:e,dataType:"json",data:{},type:"GET",success:function(e){debugger;if(e.value!=undefined){}else{sap.m.MessageToast.show("no se encontraron resultados")}}.bind(this),error:function(e){debugger;sap.m.MessageToast.show("error en la consulta "+JSON.stringify(e))}.bind(this)});this.getSplitAppObj().to(this.createId("PageLegajoImpositivo"))},logout:function(){this.getView().getModel("LoginModel").setProperty("/Logged",false);this.getView().getModel("LoginModel").setProperty("/UserData","");location.reload()},PurchaseOrders:function(e){},btnSearchPurchaseOrders:function(e){let t=this.getView().byId("DP1").getValue();let o=this.getView().byId("DP2").getValue();console.log(t+" "+o)},POSearch:function(e){debugger;var t=e.getSource();var o=t.getBindingContext("OrdersModel");var s=o.getObject();sap.m.MessageToast.show(s.DocNum);console.log("Selected row Object: ",s);this.getSplitAppObj().to(this.createId("PagePedidosDetalle"))},POPDF:function(e){debugger;var t=e.getSource();var o=t.getBindingContext("OrdersModel");var s=o.getObject();sap.m.MessageToast.show(s.DocDate);console.log("Selected row Object: ",s);console.log(t.getIcon());return;if(t.getType()===sap.m.ButtonType.Transparent){t.setType(sap.m.ButtonType.Accept)}else{t.setType(sap.m.ButtonType.Transparent)}},POLead:function(e){debugger;var t=e.getSource();var o=t.getBindingContext("OrdersModel");var s=o.getObject();sap.m.MessageToast.show(s.DocTotal);console.log("Selected row Object: ",s);return;if(t.getType()===sap.m.ButtonType.Transparent){t.setType(sap.m.ButtonType.Accept)}else{t.setType(sap.m.ButtonType.Transparent)}},docdate:function(e){var t=e.getSource();var o=this.getOwnerComponent().getModel("LoginModel").getProperty("/CardCode");debugger;if(t.getIcon()==="sap-icon://arrow-top"){t.setIcon("sap-icon://arrow-bottom");g(o,this,"desc")}else{t.setIcon("sap-icon://arrow-top");g(o,this,"asc")}},changePassword:function(){debugger;let e=this.getView().byId("newpassword1").getValue();let t=this.getView().byId("newpassword2").getValue();var o=this.getOwnerComponent().getModel("LoginModel").getProperty("/UserData");let s=this.getView().getModel("LoginModel").getProperty("/UserData/CardCode");let r=c(s,this.getView().byId("password").getValue());if(o.U_Password_Portal==r&&r!=""){if(e==t&&e!=""&&t!=""){d(s,t,this);sap.m.MessageToast.show("Contrase침a cambiada")}else{sap.m.MessageToast.show("Las contrase침as no coinciden o su formato no est치 permitido",{duration:1e4})}}else{sap.m.MessageToast.show("La combinacion usuario y contrase침a no es correcta",{duration:1e4})}}});function g(e,t,o){t.getView().getModel("OrdersModel").setProperty("/PurchaseOrders",null);var s="/b1s/v2/PurchaseOrders?$filter=CardCode eq '"+e+"'&$orderby=DocDate "+o;var r="/b1s/v2/Orders?$filter=CardCode eq 'C20000'&$orderby=DocDate "+o;jQuery.ajax({url:r,dataType:"json",data:{},success:function(e){if(e.value!=undefined){t.getView().getModel("OrdersModel").setProperty("/PurchaseOrders",e.value)}else{sap.m.MessageToast.show("no se encontraron purchase orders")}}.bind(t),error:function(e){debugger;sap.m.MessageToast.show("error en la consulta "+JSON.stringify(e))}.bind(t)})}function d(e,t,o){debugger;let s=c(e,t);let r={U_Password_Portal:s.toString()};console.log(r);var a="/b1s/v2/BusinessPartners('"+e+"')";jQuery.ajax({url:a,type:"PATCH",dataType:"json",data:JSON.stringify(r),success:function(e){debugger;console.log(e);debugger;o.getView().getModel("LoginModel").setProperty("/UserData/U_Password_Portal",t)}.bind(o),error:function(e){debugger;console.log(e)}.bind(o)})}function c(e,t){var o=t;var s=e;var r=CryptoJS.AES.encrypt(o,s);var a=CryptoJS.AES.decrypt(r,s);return a}});window.onkeyup=function(e){var t=e.keyCode?e.keyCode:e.which;if(t==83){let e=document.cookie;console.log(e)}};